SELECT
    A.ORGANIZATION_ID,
    CASE
        WHEN A.PROD_TYPE LIKE '%J%' THEN 'JUMBO'
        WHEN A.PROD_TYPE LIKE '%M%' THEN 'MET'
    END AS PROD_TYPE,
    A.TRX_DATE,
    A.BATCH_NO,
    A.ITEM_CODE AS PRODUCT_ITEM_CODE,
    B.ITEM_CODE AS INPUT_ITEM_CODE,
    ABS(A.TOTAL_QTY) AS PRODUCT_QTY,
    ABS(B.TOTAL_QTY) AS INPUT_QTY
FROM
    (SELECT
        ORGANIZATION_ID,
        PROD_TYPE,
        LINE_TYPE,
        TRX_DATE,
        BATCH_NO,
        ITEM_CODE,
        SUM(TRX_QTY) AS TOTAL_QTY
    FROM
        XXSRF.JUMBO_MET_TRANSACTIONS
    WHERE
        LINE_TYPE = 1
    GROUP BY
        ORGANIZATION_ID,
        PROD_TYPE,
        LINE_TYPE,
        TRX_DATE,
        BATCH_NO,
        ITEM_CODE) A,

    (SELECT
        ORGANIZATION_ID,
        PROD_TYPE,
        LINE_TYPE,
        TRX_DATE,
        BATCH_NO,
        ITEM_CODE,
        SUM(TRX_QTY) AS TOTAL_QTY
    FROM
        XXSRF.JUMBO_MET_TRANSACTIONS
    WHERE
        LINE_TYPE = -1
    GROUP BY
        ORGANIZATION_ID,
        PROD_TYPE,
        LINE_TYPE,
        TRX_DATE,
        BATCH_NO,
        ITEM_CODE) B
WHERE
 A.ORGANIZATION_ID = :ORGANIZATION_ID
AND A.TRX_DATE = :TRX_DATE
AND A.BATCH_NO = B.BATCH_NO
ORDER BY
    A.ORGANIZATION_ID,
    A.TRX_DATE,
    A.BATCH_NO,
    A.LINE_TYPE;




ORGANIZATION_ID	PROD_TYPE	TRX_DATE	BATCH_NO	PRODUCT_ITEM_CODE	INPUT_ITEM_CODE	PRODUCT_QTY	INPUT_QTY	PER_KG
1036	JUMBO	31-Mar-24	435550	SZ18-TI/A01_J	RCPKS407001	5331.308	245	0.046
1036	JUMBO	31-Mar-24	435550	SZ18-TI/A01_J	RPPHOMOD002	5331.308	5434	1.0193
1036	JUMBO	31-Mar-24	435550	SZ18-TI/A01_J	RPPHOMOD001	5331.308	1108	0.2078
1036	JUMBO	31-Mar-24	435550	SZ18-TI/A01_J	RC112L00001	5331.308	447	0.0838
1036	JUMBO	31-Mar-24	435550	SZ18-TI/A01_J	RAB00000037	5331.308	35	0.0066
1036	JUMBO	31-Mar-24	435550	SZ18-TI/A01_J	RC614200001	5331.308	168	0.0315
1036	JUMBO	31-Mar-24	435550	SZ18-TI/A01_J	RCXM7070S01	5331.308	19	0.0036
1036	JUMBO	31-Mar-24	435551	SZ18-TI/A01_J	RAB00000037	780.22	4	0.0051
1036	JUMBO	31-Mar-24	435551	SZ18-TI/A01_J	RCPKS407001	780.22	24	0.0308
1036	JUMBO	31-Mar-24	435551	SZ18-TI/A01_J	RC112L00001	780.22	24	0.0308
1036	JUMBO	31-Mar-24	435551	SZ18-TI/A01_J	RPPHOMOD001	780.22	112	0.1435
1036	JUMBO	31-Mar-24	435551	SZ18-TI/A01_J	RPPHOMOD002	780.22	621	0.7959
1036	JUMBO	31-Mar-24	435551	SZ18-TI/A01_J	RC614200001	780.22	16	0.0205
1036	JUMBO	31-Mar-24	435551	SZ18-TI/A01_J	RCXM7070S01	780.22	2	0.0026
1036	JUMBO	31-Mar-24	435558	SZ18-TI/A01_J	RPPHOMOD001	936.581	232	0.2477
1036	JUMBO	31-Mar-24	435558	SZ18-TI/A01_J	RCPKS407001	936.581	41	0.0438
1036	JUMBO	31-Mar-24	435558	SZ18-TI/A01_J	RAB00000037	936.581	6	0.0064
1036	JUMBO	31-Mar-24	435558	SZ18-TI/A01_J	RPPHOMOD002	936.581	1288	1.3752
1036	JUMBO	31-Mar-24	435558	SZ18-TI/A01_J	RC614200001	936.581	29	0.031
1036	JUMBO	31-Mar-24	435558	SZ18-TI/A01_J	RCXM7070S01	936.581	4	0.0043
1036	JUMBO	31-Mar-24	435558	SZ18-TI/A01_J	RC112L00001	936.581	80	0.0854
1036	JUMBO	31-Mar-24	435559	SZ18-TI/A01_J	RPPHOMOD002	5244.221	6274	1.1964
1036	JUMBO	31-Mar-24	435559	SZ18-TI/A01_J	RCXM7070S01	5244.221	17	0.0032
1036	JUMBO	31-Mar-24	435559	SZ18-TI/A01_J	RC614200001	5244.221	140	0.0267
1036	JUMBO	31-Mar-24	435559	SZ18-TI/A01_J	RAB00000037	5244.221	30	0.0057
1036	JUMBO	31-Mar-24	435559	SZ18-TI/A01_J	RCPKS407001	5244.221	201	0.0383
1036	JUMBO	31-Mar-24	435559	SZ18-TI/A01_J	RC112L00001	5244.221	382	0.0728
1036	JUMBO	31-Mar-24	435559	SZ18-TI/A01_J	RPPHOMOD001	5244.221	1193	0.2275
1036	JUMBO	31-Mar-24	435560	SZ18-TI/A01_J	RPPHOMOD002	9051.348	7506	0.8293
1036	JUMBO	31-Mar-24	435560	SZ18-TI/A01_J	RPPHOMOD001	9051.348	1422	0.1571
1036	JUMBO	31-Mar-24	435560	SZ18-TI/A01_J	RCXM7070S01	9051.348	24	0.0027
1036	JUMBO	31-Mar-24	435560	SZ18-TI/A01_J	RAB00000037	9051.348	42	0.0046
1036	JUMBO	31-Mar-24	435560	SZ18-TI/A01_J	RC112L00001	9051.348	542	0.0599
1036	JUMBO	31-Mar-24	435560	SZ18-TI/A01_J	RCPKS407001	9051.348	274	0.0303
1036	JUMBO	31-Mar-24	435560	SZ18-TI/A01_J	RC614200001	9051.348	191	0.0211
								
SUPOOSE FOR THE ABOVE DATA now it contains for multiple batch_no that are same with
 product_qty BY NAME THIS SZ18-TI/A01_J	NO I WANT TO PICK THERE UNIQE BATCH WITH SAME PRODUCT ITEM CODE AND WITH 
THERE PRODUCT QUANTITY AND THEN ITS TOTAL SUM I NEED LIKE BELOW I DEMONSTARTED 							
								
			435550	SZ18-TI/A01_J	RPPHOMOD001	5331.308		
			435551	SZ18-TI/A01_J	RPPHOMOD002	780.22		
			435558	SZ18-TI/A01_J	RPPHOMOD002	936.581		
			435559	SZ18-TI/A01_J	RAB00000037	5244.221		
			435560	SZ18-TI/A01_J	RAB00000037	9051.348		
					TOTAL	21343.678		
