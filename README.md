SELECT
    ORGANIZATION_ID,
    CASE
        WHEN PROD_TYPE LIKE '%J%' THEN 'JUMBO'
        WHEN PROD_TYPE LIKE '%M%' THEN 'MET'
    END AS PROD_TYPE,
    LINE_TYPE,
    TRX_DATE,
    BATCH_NO,
    ITEM_CODE,
    ABS(TOTAL_QTY) AS TOTAL_QTY
FROM
    (SELECT
        NVL(A.ORGANIZATION_ID, B.ORGANIZATION_ID) AS ORGANIZATION_ID,
        NVL(A.PROD_TYPE, B.PROD_TYPE) AS PROD_TYPE,
        NVL(A.LINE_TYPE, B.LINE_TYPE) AS LINE_TYPE,
        NVL(A.TRX_DATE, B.TRX_DATE) AS TRX_DATE,
        NVL(A.BATCH_NO, B.BATCH_NO) AS BATCH_NO,
        NVL(A.ITEM_CODE, B.ITEM_CODE) AS ITEM_CODE,
        NVL(A.TOTAL_QTY, 0) - NVL(B.TOTAL_QTY, 0) AS TOTAL_QTY
    FROM
        (SELECT
            ORGANIZATION_ID,
            PROD_TYPE,
            LINE_TYPE,
            TRX_DATE,
            BATCH_NO,
            ITEM_CODE,
            SUM(TRX_QTY) AS TOTAL_QTY
        FROM
            XXSRF.JUMBO_MET_TRANSACTIONS
        WHERE
            LINE_TYPE = 1
        GROUP BY
            ORGANIZATION_ID,
            PROD_TYPE,
            LINE_TYPE,
            TRX_DATE,
            BATCH_NO,
            ITEM_CODE) A,
        (SELECT
            ORGANIZATION_ID,
            PROD_TYPE,
            LINE_TYPE,
            TRX_DATE,
            BATCH_NO,
            ITEM_CODE,
            SUM(TRX_QTY) AS TOTAL_QTY
        FROM
            XXSRF.JUMBO_MET_TRANSACTIONS
        WHERE
            LINE_TYPE = -1
        GROUP BY
            ORGANIZATION_ID,
            PROD_TYPE,
            LINE_TYPE,
            TRX_DATE,
            BATCH_NO,
            ITEM_CODE) B
    WHERE
        A.ORGANIZATION_ID = B.ORGANIZATION_ID
        AND A.TRX_DATE = B.TRX_DATE
        AND A.BATCH_NO = B.BATCH_NO)
ORDER BY
    ORGANIZATION_ID,
    TRX_DATE,
    BATCH_NO,
    LINE_TYPE;



    1.A.ITEM_CODE WILL BE PRODUCT_ITEM_CODE,
B.ITEM_CODE WILL BE INPUT_ITEM_CODE, 
A.TOTAL_QTY WIL BE PRODUCT_QTY.
AND B.TOTAL_QTY WILL BE INPUT_QTY 
2.SELECT NORMALLY AND PASS PARAMETER RUNTIME 
LIKE THIS : FOR ORGANIZATION_ID AND TRX_DATE
3. YOU CAN REMOVE NVL NOW KEEP A NORMAL SINCE ITS NOT REQUIRE
