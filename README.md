To modify the code for updating data from January 1, 2024, to June 30, 2024, using `:P_START_DATE` and `:P_END_DATE` parameters, you can adjust your query to handle date ranges instead of a single period. Here's the updated query:

```sql
UPDATE PFBCUSTOM.PFB_CONTRI_SALES_NPR NPR
SET (NET_NPR, FREIGHT_AND_HANDLING, SPL_DISCOUNT, COMMISSION) = (
    SELECT 
        ROUND(NPR.GROSS_NPR - ((NVL(VD.L_OTHERTHAN_FREGHT_AMT, 0) / NULLIF(TOTAL_SALES_QTY_MT, 0)) / 1000
            + (NVL(FD_OTHER.L_TOT_FREGHT_AMT, 0) / NULLIF(TOTAL_SALES_QTY_MT, 0)) / 1000), 2) AS NET_NPR,
        ROUND(NVL(FD_OTHER.L_TOT_FREGHT_AMT, 0) / NULLIF(TOTAL_SALES_QTY_MT * 1000, 0), 4) AS FREIGHT_AND_HANDLING,
        ROUND(NVL(VD.L_OTHERTHAN_FREGHT_AMT, 0) / NULLIF(TOTAL_SALES_QTY_MT * 1000, 0), 4) AS SPL_DISCOUNT,
        ROUND(NVL(FD_COMMISSION.L_TOT_FREGHT_AMT, 0) / NULLIF(TOTAL_SALES_QTY_MT * 1000, 0), 4) AS COMMISSION
    FROM (
        SELECT 
            BSV, 
            PRODUCT_SEGMENT, 
            SUM(SALES_QTY_MT) AS TOTAL_SALES_QTY_MT
        FROM PFBCUSTOM.PFB_CONTRI_SALES_NPR
        WHERE PERIOD_NAME BETWEEN :P_START_DATE AND :P_END_DATE
        AND ORGANIZATION_ID = :ORGANIZATION_ID
        GROUP BY BSV, PRODUCT_SEGMENT
    ) TOTALS,
    (
        -- FREIGHT_DATA query
        SELECT 
            GCC.SEGMENT1 BUSINESS_UNIT,
            CASE
                WHEN TO_NUMBER(GCC.SEGMENT6) BETWEEN 15000 AND 15999 THEN 'BOPP'
                WHEN (TO_NUMBER(GCC.SEGMENT6) NOT BETWEEN 10101 AND 10111)
                     AND TO_NUMBER(GCC.SEGMENT6) < 14999 THEN 'BOPET'
            END PROD,
            NVL(SUM(DECODE(GCC.SEGMENT3, '414501', 0, ACCOUNTED_DR)), 0) - 
            NVL(SUM(DECODE(GCC.SEGMENT3, '414501', 0, ACCOUNTED_CR)), 0) L_TOT_FREGHT_AMT
        FROM 
            GL_JE_LINES GJL,
            GL_JE_HEADERS GJH,
            GL_LEDGERS GLL,
            GL_CODE_COMBINATIONS_KFV GCC,
            GL_PERIODS GP,
            HR_OPERATING_UNITS HOU
        WHERE 
            GJL.JE_HEADER_ID = GJH.JE_HEADER_ID
            AND GJH.LEDGER_ID = HOU.SET_OF_BOOKS_ID
            AND HOU.ORGANIZATION_ID = :P_ORG_ID
            AND GJL.PERIOD_NAME = GJH.PERIOD_NAME
            AND GJL.LEDGER_ID = GLL.LEDGER_ID
            AND GLL.LEDGER_CATEGORY_CODE(+) = 'PRIMARY'
            AND GJL.CODE_COMBINATION_ID = GCC.CODE_COMBINATION_ID
            AND GJH.PERIOD_NAME = GP.PERIOD_NAME
            AND GP.PERIOD_END_DATE BETWEEN :P_START_DATE AND :P_END_DATE
            AND GCC.SEGMENT3 IN ('414501', '414601', '414603')
        GROUP BY 
            GCC.SEGMENT1,
            CASE
                WHEN TO_NUMBER(GCC.SEGMENT6) BETWEEN 15000 AND 15999 THEN 'BOPP'
                WHEN (TO_NUMBER(GCC.SEGMENT6) NOT BETWEEN 10101 AND 10111)
                     AND TO_NUMBER(GCC.SEGMENT6) < 14999 THEN 'BOPET'
            END
    ) FD_OTHER,
    (
        -- FREIGHT_DATA query for COMMISSION
        SELECT 
            GCC.SEGMENT1 BUSINESS_UNIT,
            CASE
                WHEN TO_NUMBER(GCC.SEGMENT6) BETWEEN 15000 AND 15999 THEN 'BOPP'
                WHEN (TO_NUMBER(GCC.SEGMENT6) NOT BETWEEN 10101 AND 10111)
                     AND TO_NUMBER(GCC.SEGMENT6) < 14999 THEN 'BOPET'
            END PROD,
            NVL(SUM(ACCOUNTED_DR), 0) - NVL(SUM(ACCOUNTED_CR), 0) L_TOT_FREGHT_AMT
        FROM 
            GL_JE_LINES GJL,
            GL_JE_HEADERS GJH,
            GL_LEDGERS GLL,
            GL_CODE_COMBINATIONS_KFV GCC,
            GL_PERIODS GP,
            HR_OPERATING_UNITS HOU
        WHERE 
            GJL.JE_HEADER_ID = GJH.JE_HEADER_ID
            AND GJH.LEDGER_ID = HOU.SET_OF_BOOKS_ID
            AND HOU.ORGANIZATION_ID = :P_ORG_ID
            AND GJL.PERIOD_NAME = GJH.PERIOD_NAME
            AND GJL.LEDGER_ID = GLL.LEDGER_ID
            AND GLL.LEDGER_CATEGORY_CODE(+) = 'PRIMARY'
            AND GJL.CODE_COMBINATION_ID = GCC.CODE_COMBINATION_ID
            AND GJH.PERIOD_NAME = GP.PERIOD_NAME
            AND GP.PERIOD_END_DATE BETWEEN :P_START_DATE AND :P_END_DATE
            AND GCC.SEGMENT3 IN ('414501')
        GROUP BY 
            GCC.SEGMENT1,
            CASE
                WHEN TO_NUMBER(GCC.SEGMENT6) BETWEEN 15000 AND 15999 THEN 'BOPP'
                WHEN (TO_NUMBER(GCC.SEGMENT6) NOT BETWEEN 10101 AND 10111)
                     AND TO_NUMBER(GCC.SEGMENT6) < 14999 THEN 'BOPET'
            END
    ) FD_COMMISSION,
    (
        -- VOLUME_DATA query
        SELECT GCC.SEGMENT1 BUSINESS_UNIT,
                CASE
                    WHEN TO_NUMBER(GCC.SEGMENT6) BETWEEN 15000 AND 15999 THEN 'BOPP'
                    WHEN (TO_NUMBER(GCC.SEGMENT6) NOT BETWEEN 10101 AND 10111)
                         AND TO_NUMBER(GCC.SEGMENT6) < 14999 THEN 'BOPET'
                END PROD,
                NVL(SUM(ACCOUNTED_DR), 0) - NVL(SUM(ACCOUNTED_CR), 0) L_OTHERTHAN_FREGHT_AMT
         FROM GL_JE_LINES GJL,
              GL_JE_HEADERS GJH,
              GL_LEDGERS GLL,
              GL_CODE_COMBINATIONS_KFV GCC,
              GL_PERIODS GP,
              HR_OPERATING_UNITS HOU
         WHERE GJL.JE_HEADER_ID = GJH.JE_HEADER_ID
           AND GJH.LEDGER_ID = HOU.SET_OF_BOOKS_ID
           AND HOU.ORGANIZATION_ID = :P_ORG_ID
           AND GJL.PERIOD_NAME = GJH.PERIOD_NAME
           AND GJL.LEDGER_ID = GLL.LEDGER_ID
           AND GLL.LEDGER_CATEGORY_CODE(+) = 'PRIMARY'
           AND GJL.CODE_COMBINATION_ID = GCC.CODE_COMBINATION_ID
           AND GJH.PERIOD_NAME = GP.PERIOD_NAME
           AND GP.PERIOD_END_DATE BETWEEN :P_START_DATE AND :P_END_DATE
           AND GCC.SEGMENT5 <> '2161'
           AND GCC.SEGMENT3 IN ('311111', '311112', '311118', '311119')
         GROUP BY GCC.SEGMENT1,
                  CASE
                      WHEN TO_NUMBER(GCC.SEGMENT6) BETWEEN 15000 AND 15999 THEN 'BOPP'
                      WHEN (TO_NUMBER(GCC.SEGMENT6) NOT BETWEEN 10101 AND 10111)
                           AND TO_NUMBER(GCC.SEGMENT6) < 14999 THEN 'BOPET'
                  END
    ) VD
    WHERE TOTALS.BSV = FD_OTHER.BUSINESS_UNIT(+)
    AND TOTALS.BSV = FD_COMMISSION.BUSINESS_UNIT(+)
    AND TOTALS.BSV = VD.BUSINESS_UNIT(+)
    AND TOTALS.PRODUCT_SEGMENT = FD_OTHER.PROD(+)
    AND TOTALS.PRODUCT_SEGMENT = FD_COMMISSION.PROD(+)
    AND TOTALS.PRODUCT_SEGMENT = VD.PROD(+)
    AND TOTALS.BSV = NPR.BSV
    AND TOTALS.PRODUCT_SEGMENT = NPR.PRODUCT_SEGMENT
)
WHERE NPR.PERIOD_NAME BETWEEN :P_START_DATE AND :P_END_DATE
AND NPR.ORGANIZATION_ID = :ORGANIZATION_ID;
```

### Notes:
1. **Date Parameters**: The query now uses `:P_START_DATE` and `:P_END_DATE` to filter by date range.
2. **Period Name Handling**: The queries now check if `GP.PERIOD_END_DATE` falls within the specified date range to ensure accurate results.
3. **Avoiding Invalid Number Errors**: By using `NULLIF` and `NVL` functions appropriately, the query avoids division by zero and handles null values.

This